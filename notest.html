<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… NotCam - Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„ÙƒØ§Ù…Ù„</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2E86AB;
            --secondary: #A23B72;
            --success: #4CAF50;
            --danger: #F44336;
            --warning: #FF9800;
            --light: #F8F9FA;
            --dark: #212529;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .tabs {
            display: flex;
            background: var(--light);
            overflow-x: auto;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background: #eee;
            border-right: 1px solid #ddd;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .submissions-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            height: 75vh;
        }
        
        .submissions-sidebar {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
            overflow-y: auto;
        }
        
        .submission-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .submission-item:hover {
            border-color: var(--primary);
            transform: translateX(-5px);
        }
        
        .submission-item.active {
            background: var(--primary);
            color: white;
            border-color: var(--secondary);
        }
        
        .gallery-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            overflow-y: auto;
            border: 2px solid var(--light);
        }
        
        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
        }
        
        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .photo-card {
            border: 2px solid #eee;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s;
            position: relative;
        }
        
        .photo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .photo-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background: #f5f5f5;
        }
        
        .photo-info {
            padding: 15px;
            background: white;
        }
        
        .photo-type {
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .photo-number {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 90%;
        }
        
        .modal-image {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .email-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
            border: 2px solid var(--light);
        }
        
        .email-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        textarea {
            height: 150px;
            resize: vertical;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-top: 4px solid var(--primary);
        }
        
        @media (max-width: 1024px) {
            .submissions-container {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .photos-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-right: none;
                border-bottom: 1px solid #ddd;
            }
            
            .photos-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-crown"></i> Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h1>
            <p>Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Gmail</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('photos')">
                <i class="fas fa-images"></i> Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±
            </div>
            <div class="tab" onclick="showTab('email')">
                <i class="fas fa-envelope"></i> Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gmail
            </div>
            <div class="tab" onclick="showTab('stats')">
                <i class="fas fa-chart-bar"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            </div>
            <div class="tab" onclick="showTab('settings')">
                <i class="fas fa-cog"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Gmail
            </div>
            <div class="tab" onclick="showTab('test')">
                <i class="fas fa-vial"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± -->
        <div id="photosTab" class="tab-content active">
            <div class="submissions-container">
                <div class="submissions-sidebar">
                    <h3 style="margin-bottom: 20px; color: var(--primary);">
                        <i class="fas fa-list"></i> Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª
                        <span id="submissionCount" style="background: var(--primary); color: white; padding: 2px 8px; border-radius: 20px; font-size: 12px;">0</span>
                    </h3>
                    <div id="submissionsList"></div>
                </div>
                
                <div class="gallery-container">
                    <div class="gallery-header">
                        <h2 id="galleryTitle" style="color: var(--primary);">
                            <i class="fas fa-images"></i> Ø§Ø®ØªØ± ØªÙ‚Ø¯ÙŠÙ…Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±
                        </h2>
                        <div id="galleryActions" style="display: none;">
                            <button class="btn btn-success" onclick="sendCurrentToEmail()">
                                <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…
                            </button>
                            <button class="btn btn-primary" onclick="refreshSubmissions()" style="margin-right: 10px;">
                                <i class="fas fa-sync"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                        </div>
                    </div>
                    
                    <div id="photosGallery">
                        <div style="text-align: center; padding: 50px; color: #666;">
                            <i class="fas fa-images" style="font-size: 60px; margin-bottom: 20px; opacity: 0.3;"></i>
                            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø¹Ø±ÙˆØ¶Ø©</h3>
                            <p>Ø§Ø®ØªØ± ØªÙ‚Ø¯ÙŠÙ…Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø±Ø³Ø§Ù„ Gmail -->
        <div id="emailTab" class="tab-content">
            <h2><i class="fas fa-envelope"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Gmail</h2>
            <p style="color: #666; margin-bottom: 20px;">Ø£Ø±Ø³Ù„ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø£ÙŠ Ø¨Ø±ÙŠØ¯ Gmail</p>
            
            <div class="email-section">
                <div class="email-form">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> Ø§Ø®ØªØ± Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</label>
                        <select id="emailSubmission" onchange="loadSelectedSubmission()">
                            <option value="">-- Ø§Ø®ØªØ± ØªÙ‚Ø¯ÙŠÙ…Ø§Ù‹ --</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-envelope"></i> Ø¨Ø±ÙŠØ¯ Gmail Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</label>
                        <input type="email" id="recipientEmail" placeholder="example@gmail.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-edit"></i> Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
                        <input type="text" id="emailSubject" value="ğŸ“¸ Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØµÙˆØ± Ù…Ù† Ù†Ø¸Ø§Ù… NotCam" required>
                    </div>
                    
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label><i class="fas fa-comment"></i> Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
                        <textarea id="emailMessage">
Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ

ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø© Ù…Ù† Ù†Ø¸Ø§Ù… NotCam.

ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…:
â€¢ Ø§Ù„ÙƒÙˆØ¯: [CODE]
â€¢ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: [USER]
â€¢ Ø§Ù„ØªØ§Ø±ÙŠØ®: [DATE]
â€¢ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙˆØ±: [PHOTOS_COUNT]

ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©.

Ù…Ø¹ Ø®Ø§Ù„Øµ Ø§Ù„ØªØ­ÙŠØ©ØŒ
Ù…Ø´Ø±Ù Ù†Ø¸Ø§Ù… NotCam
                        </textarea>
                    </div>
                    
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label><i class="fas fa-paperclip"></i> Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª</label>
                        <div style="background: var(--light); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <div id="attachmentsList"></div>
                            <div style="margin-top: 10px;">
                                <label style="display: inline-flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="attachPhotos" checked> Ø¥Ø±ÙØ§Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±
                                </label>
                                <label style="display: inline-flex; align-items: center; gap: 10px; margin-right: 20px; cursor: pointer;">
                                    <input type="checkbox" id="attachData" checked> Ø¥Ø±ÙØ§Ù‚ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="grid-column: 1 / -1; text-align: center; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="sendEmailNow()" style="padding: 15px 40px; font-size: 18px;">
                            <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gmail Ø§Ù„Ø¢Ù†
                        </button>
                        <button class="btn" onclick="testEmailFunction()" style="background: var(--warning); color: white; margin-right: 10px;">
                            <i class="fas fa-vial"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
                        </button>
                    </div>
                </div>
                
                <div id="emailAlert" class="alert" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div id="statsTab" class="tab-content">
            <h2><i class="fas fa-chart-bar"></i> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div style="font-size: 2.5rem; color: var(--primary); font-weight: bold;" id="totalSubmissionsStat">0</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 2.5rem; color: var(--success); font-weight: bold;" id="totalPhotosStat">0</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙˆØ±</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 2.5rem; color: var(--secondary); font-weight: bold;" id="activeUsersStat">0</div>
                    <div>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 2.5rem; color: var(--warning); font-weight: bold;" id="emailsSentStat">0</div>
                    <div>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©</div>
                </div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 30px;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">Ø¢Ø®Ø± 10 ØªÙ‚Ø¯ÙŠÙ…Ø§Øª</h3>
                <div id="recentSubmissions"></div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Gmail -->
        <div id="settingsTab" class="tab-content">
            <h2><i class="fas fa-cog"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø±Ø³Ø§Ù„ Gmail</h2>
            
            <div style="background: white; padding: 30px; border-radius: 10px; margin-top: 20px;">
                <div class="form-group">
                    <label><i class="fas fa-at"></i> Ø¨Ø±ÙŠØ¯Ùƒ Gmail Ù„Ù„Ø¥Ø±Ø³Ø§Ù„</label>
                    <input type="email" id="gmailAddress" placeholder="your-email@gmail.com" style="width: 100%; max-width: 400px;">
                    <small style="color: #666; display: block; margin-top: 5px;">Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Gmail Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ù†Ù‡</small>
                </div>
                
                <div style="margin-top: 30px; padding: 20px; background: #f0f7ff; border-radius: 10px;">
                    <h4 style="color: var(--primary); margin-bottom: 15px;">
                        <i class="fas fa-info-circle"></i> ÙƒÙŠÙÙŠØ© Ø¹Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…:
                    </h4>
                    <ol style="color: #666; line-height: 2; padding-right: 20px;">
                        <li>Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ³ØªØ®Ø¯Ù… <strong>SMTP.js</strong> Ù„Ø¥Ø±Ø³Ø§Ù„ Gmail Ù…Ø¨Ø§Ø´Ø±Ø©</li>
                        <li>Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</li>
                        <li>Ø§Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ø®ØªØ± ØªÙ‚Ø¯ÙŠÙ…Ø§Ù‹ Ù„Ù„Ø¥Ø±Ø³Ø§Ù„</li>
                        <li>Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</li>
                    </ol>
                </div>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label><i class="fas fa-key"></i> ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ (App Password)</label>
                    <input type="password" id="gmailPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width: 100%; max-width: 400px;">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: 
                        <a href="https://myaccount.google.com/apppasswords" target="_blank" style="color: var(--primary); text-decoration: none;">
                            <i class="fas fa-external-link-alt"></i> Ø£Ù†Ø´Ø¦ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ù‡Ù†Ø§
                        </a>
                    </small>
                </div>
                
                <div style="margin-top: 30px;">
                    <button class="btn btn-success" onclick="saveGmailSettings()">
                        <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </button>
                    <button class="btn" onclick="sendTestToYourself()" style="background: var(--primary); color: white; margin-right: 10px;">
                        <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù†ÙØ³Ùƒ
                    </button>
                </div>
                
                <div id="settingsAlert" class="alert" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <div id="testTab" class="tab-content">
            <h2><i class="fas fa-vial"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            <p style="color: #666; margin-bottom: 20px;">Ø§Ø®ØªØ¨Ø§Ø± Ø§ØªØµØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</p>
            
            <div style="background: white; padding: 30px; border-radius: 10px; margin-top: 20px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h3 style="color: var(--primary); margin-bottom: 15px;">
                            <i class="fas fa-database"></i> ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                        </h3>
                        <div style="background: var(--light); padding: 20px; border-radius: 10px;">
                            <div id="storageInfo"></div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="checkLocalStorage()">
                                <i class="fas fa-search"></i> ÙØ­Øµ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
                            </button>
                            <button class="btn" onclick="createTestSubmission()" style="background: var(--secondary); color: white; margin-right: 10px;">
                                <i class="fas fa-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø¯ÙŠÙ… ØªØ¬Ø±ÙŠØ¨ÙŠ
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="color: var(--primary); margin-bottom: 15px;">
                            <i class="fas fa-camera"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±
                        </h3>
                        <div style="background: var(--light); padding: 20px; border-radius: 10px;">
                            <p>Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…:</p>
                            <ol style="margin-top: 10px; padding-right: 20px; color: #666;">
                                <li>Ø§ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª</li>
                                <li>Ø§Ù„ØªÙ‚Ø· ØµÙˆØ±Ø§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</li>
                                <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø±Ø³Ø§Ù„" ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</li>
                                <li>Ø§Ø±Ø¬Ø¹ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù„ÙˆØ­Ø© ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"</li>
                            </ol>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-success" onclick="refreshSubmissions()">
                                <i class="fas fa-sync"></i> ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                            <button class="btn" onclick="clearAllData()" style="background: var(--danger); color: white; margin-right: 10px;">
                                <i class="fas fa-trash"></i> Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="testResults" class="alert" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <div id="mainAlert" class="alert" style="position: fixed; top: 20px; right: 20px; z-index: 2000; max-width: 400px;"></div>
    </div>
    
    <div class="image-modal" id="imageModal">
        <div style="position: absolute; top: 20px; right: 20px;">
            <button onclick="closeImageModal()" style="background: var(--danger); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <img id="modalImage" class="modal-image">
            <div style="background: white; padding: 20px; border-radius: 0 0 10px 10px; margin-top: -5px;">
                <h3 id="modalTitle"></h3>
                <p id="modalDescription"></p>
            </div>
        </div>
    </div>

    <!-- Ù…ÙƒØªØ¨Ø© EmailJS Ù„Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ¹Ù„ÙŠ -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <script>
        // ============== Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ­Ø­ ==============
        
        let allSubmissions = [];
        let currentSubmission = null;
        let gmailSettings = JSON.parse(localStorage.getItem('gmailSettings')) || {
            gmailAddress: '',
            gmailPassword: '',
            emailsSent: 0
        };
        
        // ============== ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ==============
        function loadAllSubmissions() {
            allSubmissions = [];
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª ÙÙŠ localStorage
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
                if (key.startsWith('submission_') || key.startsWith('full_submission_') || 
                    key.startsWith('user_submission_') || key.includes('_submission_')) {
                    try {
                        const submission = JSON.parse(localStorage.getItem(key));
                        
                        if (submission && (submission.selectedCode || submission.code || submission.fieldValues)) {
                            submission.id = key;
                            submission.storageKey = key;
                            
                            // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
                            normalizeSubmissionData(submission);
                            collectSubmissionImages(submission);
                            allSubmissions.push(submission);
                        }
                    } catch (e) {
                        console.warn('ØªØ®Ø·ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø©:', key, e);
                    }
                }
            }
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ NotCam Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            scanForFormData();
            
            if (allSubmissions.length === 0) {
                createSampleSubmissions();
            }
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª Ù…Ù† Ø§Ù„Ø£Ø­Ø¯Ø« Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø¯Ù…
            allSubmissions.sort((a, b) => {
                const dateA = a.timestamp ? new Date(a.timestamp) : new Date();
                const dateB = b.timestamp ? new Date(b.timestamp) : new Date();
                return dateB - dateA;
            });
            
            renderSubmissionsList();
            updateEmailDropdown();
            updateStats();
            updateRecentSubmissions();
            loadSettings();
        }
        
        function scanForFormData() {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙØ±Ø¯ÙŠØ©
            const formDataKeys = [
                'username', 'brain_libre', 'phone', 'selectedCode',
                'firstPhotos', 'secondPhotos', 'timestamp'
            ];
            
            let submissionFound = false;
            let tempSubmission = {
                selectedCode: 'CODE-' + Date.now().toString().slice(-6),
                timestamp: new Date().toISOString(),
                fieldValues: {},
                images: []
            };
            
            formDataKeys.forEach(key => {
                const value = localStorage.getItem(key);
                if (value) {
                    if (key === 'username' || key === 'brain_libre' || key === 'phone') {
                        tempSubmission.fieldValues[key] = value;
                    } else if (key === 'selectedCode') {
                        tempSubmission.selectedCode = value;
                    } else if (key === 'timestamp') {
                        tempSubmission.timestamp = value;
                    } else if (key === 'firstPhotos' || key === 'secondPhotos') {
                        try {
                            const photos = JSON.parse(value);
                            if (Array.isArray(photos)) {
                                tempSubmission[key] = photos;
                            }
                        } catch (e) {
                            console.warn('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±:', e);
                        }
                    }
                    submissionFound = true;
                }
            });
            
            if (submissionFound && !allSubmissions.some(s => 
                s.fieldValues?.username === tempSubmission.fieldValues?.username && 
                s.selectedCode === tempSubmission.selectedCode)) {
                
                collectSubmissionImages(tempSubmission);
                allSubmissions.push(tempSubmission);
                
                // Ø­ÙØ¸ ÙƒÙ†Ù…ÙˆØ°Ø¬ ÙƒØ§Ù…Ù„
                const key = `full_submission_${tempSubmission.selectedCode}_${Date.now()}`;
                localStorage.setItem(key, JSON.stringify(tempSubmission));
            }
        }
        
        function normalizeSubmissionData(submission) {
            // ØªÙˆØ­ÙŠØ¯ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!submission.selectedCode && submission.code) {
                submission.selectedCode = submission.code;
            }
            
            if (!submission.fieldValues) {
                submission.fieldValues = {};
            }
            
            if (submission.username && !submission.fieldValues.username) {
                submission.fieldValues.username = submission.username;
            }
            
            if (submission.brain_libre && !submission.fieldValues.brain_libre) {
                submission.fieldValues.brain_libre = submission.brain_libre;
            }
            
            if (submission.phone && !submission.fieldValues.phone) {
                submission.fieldValues.phone = submission.phone;
            }
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù†ØµØ§Ù‹
            if (typeof submission.firstPhotos === 'string') {
                try {
                    submission.firstPhotos = JSON.parse(submission.firstPhotos);
                } catch (e) {
                    submission.firstPhotos = [submission.firstPhotos];
                }
            }
            
            if (typeof submission.secondPhotos === 'string') {
                try {
                    submission.secondPhotos = JSON.parse(submission.secondPhotos);
                } catch (e) {
                    submission.secondPhotos = [submission.secondPhotos];
                }
            }
        }
        
        function collectSubmissionImages(submission) {
            submission.images = [];
            
            // Ø¬Ù…Ø¹ Ø§Ù„ØµÙˆØ± Ù…Ù† firstPhotos
            if (submission.firstPhotos && Array.isArray(submission.firstPhotos)) {
                submission.firstPhotos.forEach((photo, index) => {
                    if (photo && (photo.startsWith('data:image') || photo.startsWith('http') || photo.startsWith('blob:'))) {
                        submission.images.push({
                            src: photo,
                            title: `ØµÙˆØ±Ø© Ø£ÙˆÙ„Ù‰ ${index + 1}`,
                            type: 'first'
                        });
                    }
                });
            }
            
            // Ø¬Ù…Ø¹ Ø§Ù„ØµÙˆØ± Ù…Ù† secondPhotos
            if (submission.secondPhotos && Array.isArray(submission.secondPhotos)) {
                submission.secondPhotos.forEach((photo, index) => {
                    if (photo && (photo.startsWith('data:image') || photo.startsWith('http') || photo.startsWith('blob:'))) {
                        submission.images.push({
                            src: photo,
                            title: `ØµÙˆØ±Ø© Ø«Ø§Ù†ÙŠØ© ${index + 1}`,
                            type: 'second'
                        });
                    }
                });
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ØµÙˆØ±ØŒ Ø¥Ù†Ø´Ø§Ø¡ Ø¹ÙŠÙ†Ø§Øª
            if (submission.images.length === 0) {
                submission.images = createSampleImages(submission.selectedCode);
            }
        }
        
        function createSampleImages(code) {
            return Array(10).fill().map((_, index) => ({
                src: `https://via.placeholder.com/400x300/${index < 5 ? '2E86AB' : 'A23B72'}/FFFFFF?text=${code}+${index+1}`,
                title: index < 5 ? `ØµÙˆØ±Ø© Ø£ÙˆÙ„Ù‰ ${index + 1}` : `ØµÙˆØ±Ø© Ø«Ø§Ù†ÙŠØ© ${index - 4}`,
                type: index < 5 ? 'first' : 'second'
            }));
        }
        
        function createSampleSubmissions() {
            const sampleCodes = ['AREA-001', 'AREA-002', 'AREA-003', 'AREA-004'];
            const sampleUsers = ['Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯', 'Ø³Ø§Ø±Ø© Ø®Ø§Ù„Ø¯', 'Ø¹Ù„ÙŠ Ø­Ø³Ù†', 'ÙØ§Ø·Ù…Ø© Ù…Ø­Ù…Ø¯'];
            
            sampleCodes.forEach((code, index) => {
                const submission = {
                    selectedCode: code,
                    timestamp: new Date(Date.now() - index * 86400000).toISOString(),
                    fieldValues: {
                        username: sampleUsers[index],
                        brain_libre: (index % 10).toString(),
                        phone: `05${Math.floor(Math.random() * 90000000) + 10000000}`
                    },
                    firstPhotos: Array(5).fill().map((_, i) => 
                        `https://via.placeholder.com/400x300/2E86AB/FFFFFF?text=${code}+${i+1}`
                    ),
                    secondPhotos: Array(5).fill().map((_, i) => 
                        `https://via.placeholder.com/400x300/A23B72/FFFFFF?text=${code}+${i+6}`
                    )
                };
                
                collectSubmissionImages(submission);
                
                const key = `full_submission_${code}_${Date.now()}`;
                localStorage.setItem(key, JSON.stringify(submission));
                submission.id = key;
                allSubmissions.push(submission);
            });
            
            console.log('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
            showAlert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'success');
        }
        
        // ============== Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª ==============
        function renderSubmissionsList() {
            const container = document.getElementById('submissionsList');
            const countElement = document.getElementById('submissionCount');
            
            countElement.textContent = allSubmissions.length;
            
            if (allSubmissions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #666;">
                        <i class="fas fa-database" style="font-size: 40px; margin-bottom: 15px; opacity: 0.3;"></i>
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø¯ÙŠÙ…Ø§Øª</p>
                        <button class="btn btn-primary" onclick="createTestSubmission()" style="margin-top: 10px;">
                            <i class="fas fa-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø¯ÙŠÙ… ØªØ¬Ø±ÙŠØ¨ÙŠ
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            allSubmissions.forEach((submission, index) => {
                const date = submission.timestamp ? new Date(submission.timestamp) : new Date();
                const arabicDate = date.toLocaleDateString('ar-SA');
                const time = date.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' });
                
                const div = document.createElement('div');
                div.className = 'submission-item';
                if (currentSubmission && currentSubmission.id === submission.id) {
                    div.classList.add('active');
                }
                
                div.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 5px;">
                        <i class="fas fa-qrcode"></i> ${submission.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯'}
                    </div>
                    <div style="color: #666; font-size: 14px; margin-bottom: 5px;">
                        <i class="fas fa-user"></i> ${submission.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}
                    </div>
                    <div style="color: #666; font-size: 12px;">
                        <i class="far fa-calendar"></i> ${arabicDate} ${time}
                    </div>
                    <div style="margin-top: 10px; display: flex; justify-content: space-between; font-size: 12px;">
                        <span><i class="fas fa-images"></i> ${submission.images?.length || 0}</span>
                        <span><i class="fas fa-brain"></i> ${submission.fieldValues?.brain_libre || '?'}</span>
                    </div>
                `;
                
                div.onclick = () => loadSubmissionGallery(submission);
                container.appendChild(div);
            });
            
            if (allSubmissions.length > 0 && !currentSubmission) {
                loadSubmissionGallery(allSubmissions[0]);
            }
        }
        
        function loadSubmissionGallery(submission) {
            currentSubmission = submission;
            
            const date = submission.timestamp ? new Date(submission.timestamp) : new Date();
            document.getElementById('galleryTitle').innerHTML = `
                <i class="fas fa-images"></i> ${submission.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯'}
                <span style="font-size: 16px; font-weight: normal; color: #666; margin-right: 10px;">
                    - ${submission.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'} - 
                    ${date.toLocaleDateString('ar-SA')}
                </span>
            `;
            
            document.getElementById('galleryActions').style.display = 'block';
            
            document.querySelectorAll('.submission-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = Array.from(document.querySelectorAll('.submission-item')).find(item => {
                const codeElement = item.querySelector('.fa-qrcode').nextSibling;
                return codeElement && codeElement.textContent.trim() === (submission.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯');
            });
            
            if (activeItem) activeItem.classList.add('active');
            
            displaySubmissionPhotos(submission);
        }
        
        function displaySubmissionPhotos(submission) {
            const container = document.getElementById('photosGallery');
            
            if (!submission.images || submission.images.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #666;">
                        <i class="fas fa-image-slash" style="font-size: 60px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</h3>
                        <p>Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… ÙŠØ­ØªÙˆÙŠ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†ØµÙŠØ©</p>
                    </div>
                `;
                return;
            }
            
            const firstSet = submission.images.filter(img => img.type === 'first');
            const secondSet = submission.images.filter(img => img.type === 'second');
            
            let html = '';
            
            if (firstSet.length > 0) {
                html += `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: var(--primary); margin-bottom: 15px;">
                            <i class="fas fa-camera"></i> Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (${firstSet.length} ØµÙˆØ±)
                        </h3>
                        <div class="photos-grid" id="firstSetGrid"></div>
                    </div>
                `;
            }
            
            if (secondSet.length > 0) {
                html += `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: var(--primary); margin-bottom: 15px;">
                            <i class="fas fa-camera"></i> Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (${secondSet.length} ØµÙˆØ±)
                        </h3>
                        <div class="photos-grid" id="secondSetGrid"></div>
                    </div>
                `;
            }
            
            html += `
                <div style="margin-top: 30px; padding: 20px; background: var(--light); border-radius: 10px;">
                    <h4 style="color: var(--dark); margin-bottom: 15px;">
                        <i class="fas fa-info-circle"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="font-weight: bold; color: var(--primary);">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</div>
                            <div>${submission.fieldValues?.username || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: var(--primary);">Brain Libre:</div>
                            <div>${submission.fieldValues?.brain_libre || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: var(--primary);">Ø§Ù„Ù‡Ø§ØªÙ:</div>
                            <div>${submission.fieldValues?.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: var(--primary);">Ø§Ù„ØªØ§Ø±ÙŠØ®:</div>
                            <div>${new Date(submission.timestamp || Date.now()).toLocaleString('ar-SA')}</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            
            if (firstSet.length > 0) {
                const firstGrid = document.getElementById('firstSetGrid');
                firstSet.forEach((img, index) => {
                    createPhotoCard(firstGrid, img, index + 1, 'Ø£ÙˆÙ„Ù‰');
                });
            }
            
            if (secondSet.length > 0) {
                const secondGrid = document.getElementById('secondSetGrid');
                secondSet.forEach((img, index) => {
                    createPhotoCard(secondGrid, img, index + 1, 'Ø«Ø§Ù†ÙŠØ©');
                });
            }
        }
        
        function createPhotoCard(container, img, number, type) {
            const card = document.createElement('div');
            card.className = 'photo-card';
            
            // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØµÙˆØ±Ø© ØµØ§Ù„Ø­Ø© Ù„Ù„Ø¹Ø±Ø¶
            let imgSrc = img.src;
            if (imgSrc && imgSrc.startsWith('blob:')) {
                // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„ØªØ­ÙˆÙŠÙ„ blob Ø¥Ù„Ù‰ data URL
                try {
                    // Ù‡Ø°Ù‡ ÙˆØ¸ÙŠÙØ© Ø¨Ø³ÙŠØ·Ø©ØŒ ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­ÙˆÙŠÙ„ blob
                    imgSrc = imgSrc;
                } catch (e) {
                    imgSrc = 'https://via.placeholder.com/400x300?text=ØµÙˆØ±Ø©+' + number;
                }
            }
            
            card.innerHTML = `
                <div class="photo-number">${number}</div>
                <img src="${imgSrc}" class="photo-img" alt="ØµÙˆØ±Ø© ${number}" 
                     onerror="this.onerror=null; this.src='https://via.placeholder.com/400x300?text=ØµÙˆØ±Ø©+${number}'">
                <div class="photo-info">
                    <div class="photo-type">${type} - ØµÙˆØ±Ø© ${number}</div>
                </div>
            `;
            
            card.onclick = () => viewImage(imgSrc, `${currentSubmission.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯'} - ${type} ØµÙˆØ±Ø© ${number}`);
            container.appendChild(card);
        }
        
        function viewImage(src, title) {
            document.getElementById('modalImage').src = src;
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalDescription').textContent = 
                `Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${currentSubmission.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`;
            document.getElementById('imageModal').style.display = 'block';
        }
        
        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
        }
        
        // ============== Ø¥Ø±Ø³Ø§Ù„ Gmail Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ ==============
        function loadSettings() {
            if (gmailSettings.gmailAddress) {
                document.getElementById('gmailAddress').value = gmailSettings.gmailAddress;
            }
            if (gmailSettings.gmailPassword) {
                document.getElementById('gmailPassword').value = gmailSettings.gmailPassword;
            }
        }
        
        function saveGmailSettings() {
            gmailSettings.gmailAddress = document.getElementById('gmailAddress').value.trim();
            gmailSettings.gmailPassword = document.getElementById('gmailPassword').value.trim();
            
            if (!gmailSettings.gmailAddress) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Gmail', 'error', 'settings');
                return;
            }
            
            localStorage.setItem('gmailSettings', JSON.stringify(gmailSettings));
            showAlert('ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Gmail Ø¨Ù†Ø¬Ø§Ø­', 'success', 'settings');
            
            // ØªÙ‡ÙŠØ¦Ø© EmailJS
            initEmailJS();
        }
        
        function initEmailJS() {
            if (gmailSettings.gmailAddress && gmailSettings.gmailPassword) {
                // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… EmailJS Ù…Ø¹ Ù…ÙØªØ§Ø­ API
                // Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ù…Ø¨Ø³Ø·
                console.log('ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯');
                showAlert('ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', 'success');
            }
        }
        
        function updateEmailDropdown() {
            const select = document.getElementById('emailSubmission');
            select.innerHTML = '<option value="">-- Ø§Ø®ØªØ± ØªÙ‚Ø¯ÙŠÙ…Ø§Ù‹ --</option>';
            
            allSubmissions.forEach((sub, index) => {
                const date = new Date(sub.timestamp || Date.now());
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${sub.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯'} - ${sub.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'} - ${date.toLocaleDateString('ar-SA')}`;
                select.appendChild(option);
            });
        }
        
        function loadSelectedSubmission() {
            const select = document.getElementById('emailSubmission');
            const index = parseInt(select.value);
            
            if (!isNaN(index) && allSubmissions[index]) {
                const submission = allSubmissions[index];
                const message = document.getElementById('emailMessage');
                message.value = message.value
                    .replace('[CODE]', submission.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯')
                    .replace('[USER]', submission.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ')
                    .replace('[DATE]', new Date(submission.timestamp || Date.now()).toLocaleString('ar-SA'))
                    .replace('[PHOTOS_COUNT]', submission.images?.length || 0);
                updateAttachmentsList(submission);
            }
        }
        
        function updateAttachmentsList(submission) {
            const container = document.getElementById('attachmentsList');
            
            if (!submission.images || submission.images.length === 0) {
                container.innerHTML = '<div style="color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</div>';
                return;
            }
            
            let html = `
                <div style="margin-bottom: 10px;">
                    <i class="fas fa-paperclip"></i> Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
            `;
            
            submission.images.slice(0, 6).forEach((img, index) => {
                html += `
                    <div style="background: white; padding: 8px 12px; border-radius: 5px; font-size: 12px; border: 1px solid #ddd;">
                        <i class="fas fa-image"></i> ${img.title || `ØµÙˆØ±Ø© ${index + 1}`}
                    </div>
                `;
            });
            
            if (submission.images.length > 6) {
                html += `<div style="background: white; padding: 8px 12px; border-radius: 5px; font-size: 12px; border: 1px solid #ddd;">
                    +${submission.images.length - 6} ØµÙˆØ±Ø©
                </div>`;
            }
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        async function sendEmailNow() {
            const email = document.getElementById('recipientEmail').value.trim();
            const subject = document.getElementById('emailSubject').value;
            const message = document.getElementById('emailMessage').value;
            
            if (!email || !subject || !message) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error', 'email');
                return;
            }
            
            if (!validateEmail(email)) {
                showAlert('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­', 'error', 'email');
                return;
            }
            
            if (!gmailSettings.gmailAddress || !gmailSettings.gmailPassword) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Gmail Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error', 'email');
                return;
            }
            
            const select = document.getElementById('emailSubmission');
            const submissionIndex = parseInt(select.value);
            
            if (isNaN(submissionIndex) || !allSubmissions[submissionIndex]) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªÙ‚Ø¯ÙŠÙ… ØµØ§Ù„Ø­', 'error', 'email');
                return;
            }
            
            const submission = allSubmissions[submissionIndex];
            
            showAlert('Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø¥Ù„Ù‰ Gmail...', 'success', 'email');
            
            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… EmailJS Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„ÙØ¹Ù„ÙŠ
                await sendWithEmailJS(submission, email, subject, message);
                
                // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
                gmailSettings.emailsSent++;
                localStorage.setItem('gmailSettings', JSON.stringify(gmailSettings));
                updateStats();
                
                showAlert('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ Gmail!', 'success', 'email');
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„
                createDataPackage(submission);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:', error);
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø±ÙŠÙ‚Ø© mailto ÙƒØ¨Ø¯ÙŠÙ„
                const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(message)}`;
                window.open(mailtoLink, '_blank');
                
                showAlert('ğŸ“§ ØªÙ… ÙØªØ­ Ø¨Ø±ÙŠØ¯Ùƒ Gmail. Ø£Ø¶Ù Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹.', 'success', 'email');
                createDataPackage(submission);
            }
        }
        
        async function sendWithEmailJS(submission, toEmail, subject, message) {
            // Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… EmailJS - Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨ ÙÙŠ emailjs.com
            try {
                // ØªÙ‡ÙŠØ¦Ø© EmailJS (Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ)
                emailjs.init("YOUR_PUBLIC_KEY"); // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø¹Ø§Ù…
                
                const templateParams = {
                    to_email: toEmail,
                    from_name: 'Ù†Ø¸Ø§Ù… NotCam',
                    subject: subject,
                    message: message,
                    code: submission.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯',
                    username: submission.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                    brain_libre: submission.fieldValues?.brain_libre || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    phone: submission.fieldValues?.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    date: new Date(submission.timestamp || Date.now()).toLocaleString('ar-SA'),
                    photos_count: submission.images?.length || 0
                };
                
                const response = await emailjs.send(
                    'service_ut8ln4l', // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…Ø¹Ø±Ù Ø§Ù„Ø®Ø¯Ù…Ø©
                    'template_pc94202', // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ø§Ù„Ø¨
                    templateParams
                );
                
                return response;
            } catch (error) {
                throw error;
            }
        }
        
        function createDataPackage(submission) {
            const packageData = {
                submission: submission,
                exportDate: new Date().toISOString(),
                system: 'NotCam Admin System'
            };
            
            const dataStr = JSON.stringify(packageData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `notcam_${submission.selectedCode || 'data'}_${Date.now()}.json`;
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            console.log('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØ­Ù…ÙŠÙ„');
        }
        
        function sendCurrentToEmail() {
            if (!currentSubmission) {
                showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ù…Ø­Ø¯Ø¯', 'error');
                return;
            }
            
            showTab('email');
            
            const index = allSubmissions.findIndex(s => s.id === currentSubmission.id);
            if (index !== -1) {
                document.getElementById('emailSubmission').value = index;
                loadSelectedSubmission();
            }
            
            if (gmailSettings.gmailAddress) {
                document.getElementById('recipientEmail').value = gmailSettings.gmailAddress;
            }
            
            showAlert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ. Ø£Ø¶Ù Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¥Ø±Ø³Ø§Ù„', 'success', 'email');
        }
        
        function testEmailFunction() {
            const testEmail = prompt('Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Gmail Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±:', 'hichamverne@gmail.com');
            
            if (testEmail && validateEmail(testEmail)) {
                document.getElementById('recipientEmail').value = testEmail;
                document.getElementById('emailSubject').value = 'ğŸ“§ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø±Ø³Ø§Ù„ Ù…Ù† Ù†Ø¸Ø§Ù… NotCam';
                document.getElementById('emailMessage').value = 'Ù‡Ø°Ø§ Ø¨Ø±ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gmail.\n\nØ¥Ø°Ø§ Ø§Ø³ØªÙ„Ù…Øª Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ØŒ ÙØ§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.';
                
                showAlert('ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±. Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gmail Ø§Ù„Ø¢Ù†"', 'success', 'email');
            }
        }
        
        function sendTestToYourself() {
            if (!gmailSettings.gmailAddress) {
                showAlert('Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Gmail Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error');
                return;
            }
            
            document.getElementById('recipientEmail').value = gmailSettings.gmailAddress;
            document.getElementById('emailSubject').value = 'Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… NotCam';
            document.getElementById('emailMessage').value = 'Ù‡Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù†Ø¸Ø§Ù… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.\n\nØ¥Ø°Ø§ Ø§Ø³ØªÙ„Ù…Øª Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ØŒ ÙØ§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­.';
            
            showAlert('ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±. Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gmail Ø§Ù„Ø¢Ù†"', 'success', 'email');
        }
        
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        // ============== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ==============
        function updateStats() {
            document.getElementById('totalSubmissionsStat').textContent = allSubmissions.length;
            document.getElementById('totalPhotosStat').textContent = allSubmissions.reduce((sum, sub) => sum + (sub.images?.length || 0), 0);
            
            const users = new Set();
            allSubmissions.forEach(sub => {
                if (sub.fieldValues?.username) {
                    users.add(sub.fieldValues.username);
                }
            });
            document.getElementById('activeUsersStat').textContent = users.size;
            
            document.getElementById('emailsSentStat').textContent = gmailSettings.emailsSent || 0;
        }
        
        function updateRecentSubmissions() {
            const container = document.getElementById('recentSubmissions');
            const recent = allSubmissions.slice(0, 10);
            
            if (recent.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø¯ÙŠÙ…Ø§Øª Ø­Ø¯ÙŠØ«Ø©</p>';
                return;
            }
            
            let html = '<div style="overflow-x: auto;">';
            html += '<table style="width: 100%; border-collapse: collapse;">';
            html += '<thead><tr style="background: var(--light);">';
            html += '<th style="padding: 10px; text-align: right;">Ø§Ù„ÙƒÙˆØ¯</th>';
            html += '<th style="padding: 10px; text-align: right;">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>';
            html += '<th style="padding: 10px; text-align: right;">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>';
            html += '<th style="padding: 10px; text-align: right;">Ø§Ù„ØµÙˆØ±</th>';
            html += '</tr></thead><tbody>';
            
            recent.forEach(sub => {
                const date = new Date(sub.timestamp || Date.now());
                html += `<tr style="border-bottom: 1px solid #eee;">`;
                html += `<td style="padding: 10px;">${sub.selectedCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯'}</td>`;
                html += `<td style="padding: 10px;">${sub.fieldValues?.username || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>`;
                html += `<td style="padding: 10px;">${date.toLocaleDateString('ar-SA')}</td>`;
                html += `<td style="padding: 10px;">${sub.images?.length || 0}</td>`;
                html += `</tr>`;
            });
            
            html += '</tbody></table></div>';
            container.innerHTML = html;
        }
        
        // ============== Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… ==============
        function checkLocalStorage() {
            const container = document.getElementById('storageInfo');
            let html = '<h4 style="color: var(--primary); margin-bottom: 10px;">Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:</h4>';
            html += '<div style="max-height: 200px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px;">';
            
            let count = 0;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                html += `<div style="padding: 5px 0; border-bottom: 1px solid #eee; font-family: monospace;">${key}</div>`;
                count++;
            }
            
            html += `</div><div style="margin-top: 10px; color: var(--success);">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙØ§ØªÙŠØ­: ${count}</div>`;
            container.innerHTML = html;
            
            showTestAlert(`ØªÙ… ÙØ­Øµ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ: ${count} Ù…ÙØªØ§Ø­`, 'success');
        }
        
        function createTestSubmission() {
            const testCode = `TEST-${Date.now().toString().slice(-6)}`;
            const submission = {
                selectedCode: testCode,
                timestamp: new Date().toISOString(),
                fieldValues: {
                    username: 'Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ',
                    brain_libre: '5.5',
                    phone: '0512345678'
                },
                firstPhotos: [
                    'https://via.placeholder.com/400x300/2E86AB/FFFFFF?text=ØµÙˆØ±Ø©+ØªØ¬Ø±ÙŠØ¨ÙŠØ©+1',
                    'https://via.placeholder.com/400x300/2E86AB/FFFFFF?text=ØµÙˆØ±Ø©+ØªØ¬Ø±ÙŠØ¨ÙŠØ©+2'
                ],
                secondPhotos: [
                    'https://via.placeholder.com/400x300/A23B72/FFFFFF?text=ØµÙˆØ±Ø©+ØªØ¬Ø±ÙŠØ¨ÙŠØ©+3',
                    'https://via.placeholder.com/400x300/A23B72/FFFFFF?text=ØµÙˆØ±Ø©+ØªØ¬Ø±ÙŠØ¨ÙŠØ©+4'
                ]
            };
            
            collectSubmissionImages(submission);
            
            const key = `test_submission_${testCode}`;
            localStorage.setItem(key, JSON.stringify(submission));
            submission.id = key;
            allSubmissions.unshift(submission);
            
            renderSubmissionsList();
            updateEmailDropdown();
            updateStats();
            
            showTestAlert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø¯ÙŠÙ… ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            loadSubmissionGallery(submission);
        }
        
        function refreshSubmissions() {
            loadAllSubmissions();
            showAlert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
        }
        
        function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª Ù…Ù† localStorage
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('submission_') || key.startsWith('full_submission_') || 
                        key.startsWith('user_submission_') || key.startsWith('test_submission_')) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => {
                    localStorage.removeItem(key);
                });
                
                allSubmissions = [];
                currentSubmission = null;
                
                renderSubmissionsList();
                updateStats();
                
                showTestAlert('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }
        
        function showTestAlert(message, type) {
            const alertDiv = document.getElementById('testResults');
            alertDiv.textContent = message;
            alertDiv.className = `alert alert-${type}`;
            alertDiv.style.display = 'block';
            
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 5000);
        }
        
        // ============== Ø¯ÙˆØ§Ù„ Ø¹Ø§Ù…Ø© ==============
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const tabElement = document.querySelector(`.tab[onclick*="${tabName}"]`);
            if (tabElement) {
                tabElement.classList.add('active');
            }
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }
        
        function showAlert(message, type, target = 'main') {
            const alertId = target === 'main' ? 'mainAlert' : `${target}Alert`;
            const alertDiv = document.getElementById(alertId);
            
            if (alertDiv) {
                alertDiv.textContent = message;
                alertDiv.className = `alert alert-${type}`;
                alertDiv.style.display = 'block';
                
                setTimeout(() => {
                    alertDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
        window.onload = function() {
            loadAllSubmissions();
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ø²Ø± ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeImageModal();
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ Ù„Ù„ÙƒØ´Ù Ø¹Ù† ØªÙ‚Ø¯ÙŠÙ…Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
            setInterval(refreshSubmissions, 5000);
            
            showAlert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        };
    </script>
</body>
</html>
